# InvestTrack - ä¸ªäººæŠ•èµ„ç­–ç•¥è¿½è¸ªç³»ç»Ÿ (NAS Edition)

**InvestTrack** æ˜¯ä¸€ä¸ªåŸºäºâ€œç­–ç•¥é©±åŠ¨â€å’Œâ€œæœˆåº¦å¿«ç…§â€æ–¹æ³•è®ºçš„ä¸ªäººèµ„äº§ç®¡ç†å·¥å…·ã€‚

ä¸ä¼ ç»Ÿçš„è®°è´¦è½¯ä»¶ä¸åŒï¼Œå®ƒä¸å…³æ³¨æ¯ä¸€ç¬”çç¢çš„äº¤æ˜“æµæ°´ï¼Œè€Œæ˜¯å…³æ³¨**æ¯ä¸ªæœˆæœˆåº•çš„èµ„äº§çŠ¶æ€**ä»¥åŠ**å®é™…æŒä»“ä¸ç›®æ ‡ç­–ç•¥çš„åå·®**ã€‚

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œä¸“ä¸ºéƒ¨ç½²åœ¨å®¶åº­ NASï¼ˆå¦‚ç¾¤æ™–ã€å¨è”é€šï¼‰æˆ–ä¸ªäººæœåŠ¡å™¨è®¾è®¡ï¼Œæ•°æ®å­˜å‚¨äº SQLite æ•°æ®åº“ä¸­ï¼Œå®‰å…¨å¯æ§ï¼Œéšç§æ— å¿§ã€‚

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

1.  **ğŸ“Š ä»ªè¡¨ç›˜ (Dashboard)**
    *   å¯è§†åŒ–å±•ç¤ºèµ„äº§åˆ†å¸ƒã€å†å²å‡€å€¼æ›²çº¿ã€ç´¯è®¡æŠ•å…¥ä¸ç›ˆäºã€‚
    *   è‡ªåŠ¨è®¡ç®—å½“å‰æŒä»“ä¸ç›®æ ‡ç­–ç•¥çš„åç¦»åº¦ã€‚
    *   **åŒºé—´åˆ†æ**: æ”¯æŒæŸ¥çœ‹â€œä»Šå¹´ä»¥æ¥(YTD)â€æˆ–â€œè¿‘ä¸€å¹´â€çš„**åŒºé—´ç›ˆåˆ©**ï¼Œè€Œéä»…ä»…æ˜¯å†å²æ€»ç›ˆåˆ©ã€‚

2.  **âš–ï¸ ç­–ç•¥ç®¡ç† (Strategy IPS)**
    *   å®šä¹‰æ‚¨çš„æŠ•èµ„â€œå®ªæ³•â€ã€‚
    *   åˆ›å»ºä¸åŒç‰ˆæœ¬çš„æŠ•èµ„ç»„åˆç­–ç•¥ï¼ˆå¦‚ï¼š2024 æ¿€è¿›ç‰ˆï¼‰ã€‚
    *   è®¾ç½®å…·ä½“çš„èµ„äº§é…ç½®ç›®æ ‡æ¯”ä¾‹ï¼ˆå¦‚ï¼šæ²ªæ·±300 40% + çº³æ–¯è¾¾å…‹ 30%ï¼‰ã€‚

3.  **ğŸ—ƒï¸ èµ„äº§åº“ç®¡ç† (Asset Library)**
    *   ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æŠ•èµ„æ ‡çš„ï¼ˆè‚¡ç¥¨ã€åŸºé‡‘ã€é»„é‡‘ã€åŠ å¯†è´§å¸ã€å®šå­˜ç­‰ï¼‰ã€‚
    *   æ”¯æŒ**æ—¶å…‰æœºæ¨¡å¼**ï¼šå›æº¯æŸ¥çœ‹å†å²ä¸ŠæŸä¸ªæœˆåº•çš„å…·ä½“æŒä»“åˆ—è¡¨ã€‚

4.  **ğŸ“¸ æœˆåº¦å¿«ç…§ (Snapshots)**
    *   **æ ¸å¿ƒé€»è¾‘**ï¼šæ¯æœˆåªéœ€è®°å½•ä¸€æ¬¡èµ„äº§çŠ¶æ€ã€‚
    *   **è¯åˆ¸ç±»**ï¼šè®°å½•ä»½é¢å˜åŠ¨å’Œå½“å‰å•ä»·ã€‚
    *   **å­˜é‡ç±»**ï¼šè®°å½•å½“å‰æ€»å€¼ã€‚
    *   è‡ªåŠ¨è®¡ç®—æœˆåº¦æµæ°´ã€æŠ•å…¥æœ¬é‡‘å˜åŒ–ã€‚
    *   **æŠ•èµ„ç¬”è®°**ï¼šæ”¯æŒ Markdown æ ¼å¼è®°å½•æ¯æœˆçš„æŠ•èµ„æ€è€ƒä¸å¤ç›˜ã€‚

---

## ğŸ“– ä½¿ç”¨æ‰‹å†Œ (User Manual)

### 1. æ ¸å¿ƒè®¾è®¡ç†å¿µ

InvestTrack é‡‡ç”¨ **â€œæœˆåº¦å¿«ç…§ (Monthly Snapshot)â€** ä¸ **â€œç­–ç•¥é©±åŠ¨ (Strategy Driven)â€** çš„æ ¸å¿ƒæ–¹æ³•è®ºã€‚

*   **ç­–ç•¥é©±åŠ¨**: æŠ•èµ„ä¸åº”æ˜¯éšæœºçš„ï¼Œè€Œåº”åŸºäºæ—¢å®šçš„èµ„äº§é…ç½®æ¯”ä¾‹ï¼ˆIPSï¼‰ã€‚ç³»ç»Ÿä¼šæ—¶åˆ»è®¡ç®—æ‚¨å½“å‰çš„å®é™…æŒä»“ä¸ç›®æ ‡ç­–ç•¥çš„åç¦»åº¦ï¼Œè¾…åŠ©æ‚¨è¿›è¡ŒåŠ¨æ€å¹³è¡¡ã€‚
*   **å…³æ³¨å­˜é‡**: ä¸åŒäºè®°è´¦è½¯ä»¶è®°å½•æ¯ä¸€ç¬”â€œä¹°æ—©é¤â€ã€â€œå‘å·¥èµ„â€çš„æµæ°´ï¼ŒInvestTrack å…³æ³¨çš„æ˜¯**æœˆåº•æ—¶åˆ»**æ‚¨çš„èµ„äº§è´Ÿå€ºè¡¨çŠ¶æ€ã€‚

### 2. æ ¸å¿ƒæ•°æ®é€»è¾‘

ä¸ºäº†å‡†ç¡®ä¸”é«˜æ•ˆåœ°è®°å½•ä¸åŒç±»å‹çš„èµ„äº§ï¼Œç³»ç»Ÿé‡‡ç”¨äº†ä¸¤å¥—æ•°æ®é€»è¾‘ï¼š

#### A. ä»½é¢ç´¯ç§¯åˆ¶ (é€‚ç”¨äºï¼šè‚¡ç¥¨ã€åŸºé‡‘ã€ETF)
è¿™ç±»èµ„äº§é€šå¸¸æœ‰ç¡®å®šçš„â€œä»½é¢â€å’Œâ€œå‡€å€¼â€ã€‚
*   **é€»è¾‘**: `æœ¬æœˆæŒæœ‰ä»½é¢ = ä¸ŠæœˆæŒæœ‰ä»½é¢ + æœ¬æœˆæ–°å¢ä»½é¢`
*   **è®°å½•æ–¹å¼**: æ¯æœˆè®°è´¦æ—¶ï¼Œæ‚¨åªéœ€è¾“å…¥**æœ¬æœˆå‘ç”Ÿçš„å˜åŠ¨**ï¼ˆä¹°å…¥/å–å‡ºä»½é¢ã€æŠ•å…¥/å–å‡ºæœ¬é‡‘ï¼‰ä»¥åŠ**æœˆåº•çš„æ”¶ç›˜ä»·**ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—æ€»å¸‚å€¼å’Œç´¯è®¡å›æŠ¥ã€‚

#### B. çŠ¶æ€å¿«ç…§åˆ¶ (é€‚ç”¨äºï¼šå®ç‰©é»„é‡‘ã€å®šæœŸå­˜æ¬¾ã€ç°é‡‘)
è¿™ç±»èµ„äº§é€šå¸¸å…³æ³¨çš„æ˜¯æ€»å€¼ï¼Œæˆ–æ²¡æœ‰æ˜ç¡®çš„â€œä»½é¢â€æ¦‚å¿µï¼ˆå¦‚å¤šç¬”ä¸åŒæœŸé™çš„å®šå­˜ï¼‰ã€‚
*   **é€»è¾‘**: ç³»ç»Ÿé»˜è®¤å°†ä¸Šä¸ªæœˆçš„æœ€ç»ˆçŠ¶æ€å¤åˆ¶ä¸ºæœ¬æœˆçš„èµ·ç‚¹ã€‚
*   **è®°å½•æ–¹å¼**: ç›´æ¥ä¿®æ”¹**å½“å‰çš„æ€»é‡**ã€‚
    *   *ä¾‹å­*: 3æœˆæŒæœ‰ 50g é»„é‡‘ã€‚7æœˆåˆä¹°äº† 10gã€‚åœ¨è®°å½• 7 æœˆè´¦æœ¬æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¸¦å‡º 50gï¼Œæ‚¨åªéœ€å°†å…¶ä¿®æ”¹ä¸º **60g** å³å¯ã€‚ç³»ç»Ÿåªå…³å¿ƒâ€œ7æœˆåº•è¿™ä¸€åˆ»ä½ æ€»å…±æœ‰å¤šå°‘â€ã€‚

### 3. æ•°æ®åº“è®¾è®¡è¯¦è§£ (Database Schema)

è™½ç„¶å‰ç«¯é’ˆå¯¹ä¸¤ç±»èµ„äº§æä¾›äº†ä¸åŒçš„äº¤äº’æ–¹å¼ï¼Œä½†åœ¨åç«¯æ•°æ®åº“ï¼ˆSQLiteï¼‰ä¸­ï¼Œå®ƒä»¬è¢«**å½’ä¸€åŒ–**å­˜å‚¨åœ¨åŒä¸€å¼ è¡¨ä¸­ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†æ•°æ®ç»“æ„çš„ç®€æ´å’Œç»Ÿè®¡çš„é«˜æ•ˆã€‚

#### æ ¸å¿ƒè¡¨ç»“æ„å…³ç³»
*   **snapshots è¡¨ (1)**: ä»£è¡¨â€œæŸä¸ªæœˆçš„è´¦æœ¬å°é¢â€ã€‚å­˜å‚¨æ—¥æœŸã€å½“æœˆæ€»å¸‚å€¼ã€å½“æœˆæŠ•èµ„ç¬”è®°ã€‚
*   **positions è¡¨ (N)**: ä»£è¡¨â€œè´¦æœ¬é‡Œçš„æ¯ä¸€è¡Œè®°å½•â€ã€‚å­˜å‚¨å…·ä½“èµ„äº§åœ¨å½“æœˆçš„çŠ¶æ€ã€‚

#### ç»Ÿä¸€æ˜ å°„é€»è¾‘
æ— è®ºèµ„äº§ç±»å‹å¦‚ä½•ï¼Œéƒ½ä¼šæ˜ å°„åˆ° `positions` è¡¨çš„ä»¥ä¸‹å­—æ®µï¼š

| æ•°æ®åº“å­—æ®µ | è‚¡ç¥¨/åŸºé‡‘ (Type A) | å®šå­˜/ç°é‡‘ (Type B) | é€»è¾‘è¯´æ˜ |
| :--- | :--- | :--- | :--- |
| **quantity** | **æŒä»“è‚¡æ•°** (å¦‚ 1000) | **æ€»é‡‘é¢** (å¦‚ 50000) | ç»Ÿä¸€ä»£è¡¨â€œæŒæœ‰é‡â€ |
| **price** | **å¸‚åœºå•ä»·** (å¦‚ 280.5) | **1.00** (æ’å®šä¸º1) | ç°é‡‘çš„å•ä»·æ°¸è¿œæ˜¯1 |
| **market_value** | `quantity * price` | `quantity * 1` | **ç»Ÿä¸€å¸‚å€¼ (æ ¸å¿ƒç»Ÿè®¡æŒ‡æ ‡)** |
| **added_principal**| **æœ¬æœˆä¹°å…¥é‡‘é¢** | **æœ¬æœˆå­˜å…¥é‡‘é¢** | ç»Ÿä¸€ä»£è¡¨â€œæœ¬é‡‘æŠ•å…¥(æµæ°´)â€ |
| **added_quantity** | **æœ¬æœˆä¹°å…¥è‚¡æ•°** | **æœ¬æœˆå­˜å…¥é‡‘é¢** | ç»Ÿä¸€ä»£è¡¨â€œä»½é¢å¢é‡â€ |

---

## ğŸ§  é«˜çº§æ•°æ®åˆ†æ (SQL Recipes)

ç”±äºæ•°æ®å­˜å‚¨åœ¨æ ‡å‡†çš„ SQLite æ•°æ®åº“ä¸­ï¼Œæ‚¨å¯ä»¥ç›´æ¥è¿æ¥æ•°æ®åº“è¿›è¡Œæ·±åº¦åˆ†æã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„åˆ†æåœºæ™¯ SQLï¼š

### ğŸ“… åœºæ™¯1ï¼šæŸ¥çœ‹ä»Šå¹´è‡³ä»Šçš„æœˆåº¦è¡¨ç°
```sql
SELECT date, total_value, total_invested, 
       total_value - total_invested as profit
FROM snapshots 
WHERE strftime('%Y', date) = '2024'
ORDER BY date;
```

### ğŸ’° åœºæ™¯2ï¼šè®¡ç®—ä»Šå¹´ç´¯è®¡æŠ•å…¥å’ŒåŒºé—´æ”¶ç›Š
*é€»è¾‘ï¼šä»Šå¹´èµšçš„é’± = (å¹´æœ«æ€»å€¼ - å¹´æœ«æ€»æŠ•å…¥) - (å¹´åˆæ€»å€¼ - å¹´åˆæ€»æŠ•å…¥)*
```sql
WITH year_start AS (
    SELECT total_value, total_invested FROM snapshots WHERE date = '2023-12' -- åŸºå‡†ç‚¹
),
year_end AS (
    SELECT total_value, total_invested FROM snapshots ORDER BY date DESC LIMIT 1 -- å½“å‰ç‚¹
)
SELECT 
    (e.total_value - e.total_invested) - (s.total_value - s.total_invested) as year_profit
FROM year_end e, year_start s;
```

### ğŸš€ åœºæ™¯3ï¼šæŠ•èµ„æ”¶ç›Šå½’å› åˆ†æ (è°èµšå¾—æœ€å¤š?)
*åˆ†æä»Šå¹´å„ä¸ªèµ„äº§å¯¹æ€»æ”¶ç›Šçš„è´¡çŒ®åº¦*
```sql
WITH monthly_changes AS (
    SELECT 
        a.name,
        s.date,
        p.market_value,
        LAG(p.market_value) OVER (PARTITION BY p.asset_id ORDER BY s.date) as prev_value,
        p.added_principal
    FROM positions p
    JOIN snapshots s ON p.snapshot_id = s.id
    JOIN assets a ON p.asset_id = a.id
    WHERE s.date >= '2024-01'
)
SELECT 
    name,
    SUM(market_value - prev_value - COALESCE(added_principal, 0)) as market_return
FROM monthly_changes
WHERE prev_value IS NOT NULL
GROUP BY name
ORDER BY market_return DESC;
```

---

## ğŸ›  æŠ€æœ¯æ ˆ

*   **å‰ç«¯ (Frontend)**: React 19, TypeScript, Vite, Tailwind CSS, Recharts
*   **åç«¯ (Backend)**: Node.js, Express, SQLite3

---

## ğŸš€ å¼€å‘æŒ‡å— (Local Development)

### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

### 2. å¯åŠ¨åç«¯æœåŠ¡
```bash
node server.js
```
*   æœåŠ¡å¯åŠ¨åœ¨ `http://localhost:3001`ï¼Œå¹¶è‡ªåŠ¨åˆ›å»º `invest_track.db`ã€‚

### 3. å¯åŠ¨å‰ç«¯
```bash
npm run dev
```

---

## â˜ï¸ éƒ¨ç½²æŒ‡å— (NAS / Server Deployment)

1.  **æ„å»ºå‰ç«¯**: `npm run build`
2.  **å‡†å¤‡ç›®å½•**: å°† `dist/` æ–‡ä»¶å¤¹, `server.js`, `package.json` æ”¾å…¥ NAS æ–‡ä»¶å¤¹ã€‚
3.  **å®‰è£…ä¾èµ–**: `npm install express sqlite3 cors uuid`
4.  **è¿è¡Œ**: `node server.js` (æˆ–ä½¿ç”¨ PM2 æ‰˜ç®¡)
